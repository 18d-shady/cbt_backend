{% extends "unfold/layouts/base.html" %}
{% block content %}
<h2>Manual Grading: {{ exam.title }}</h2>

<form method="post">
    {% csrf_token %}
    <table style="width:100%; border-collapse: collapse;">
        <thead>
            <tr style="background: #79aec8; color: white; text-align: left;">
                <th style="padding: 10px;">Student</th>
                <th style="padding: 10px;">Question #</th>
                <th style="padding: 10px; width: 40%;">Student's Response</th>
                <th style="padding: 10px;">Award Mark</th>
            </tr>
        </thead>
        <tbody>
            {% for answer in answers %}
            <tr style="border-bottom: 1px solid #eee; {% if answer.is_graded %}background-color: #f8fff8;{% endif %}">
                <td style="padding: 15px;">
                    <strong>{{ answer.user.get_full_name }}</strong><br>
                    <span style="color: #666; font-size: 0.8em;">ID: {{ answer.user.username }}</span>
                </td>
                <td style="padding: 15px; text-align: center;">Q{{ answer.question.question_number }}</td>
                <td style="padding: 15px;">
                    <div style="background: #fff; padding: 12px; border: 1px solid #ddd; border-radius: 5px; font-family: monospace;">
                        {{ answer.answer_text|linebreaks }}
                    </div>
                </td>
                <td style="padding: 15px;">
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <input type="number" 
                            step="0.5" 
                            min="0" 
                            max="{{ answer.question.point }}" 
                            name="score_{{ answer.id }}" 
                            value="{{ answer.points_earned|default:'' }}"
                            style="width: 70px; padding: 8px; border: 2px solid #417690; border-radius: 4px;"
                            placeholder="0.0">
                        <span style="font-weight: bold; color: #417690;">/ {{ answer.question.point }}</span>
                    </div>
                    <small style="color: #999;">Max points for this question</small>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    {% if answers %}
    <div class="submit-row" style="margin-top: 20px;">
        <input type="submit" value="Save All Grades" class="default" style="background: #417690; color: white; padding: 10px 20px; border: none; cursor: pointer;">
    </div>
    {% endif %}
</form>
{% endblock %}